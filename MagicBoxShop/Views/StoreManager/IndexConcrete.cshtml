@using MagicBoxShop
@model MagicBoxShop.Models.PageableData<MagicBoxShop.Models.Product>

@helper Truncate(string input, int length)
{
    if (input.Length <= length) {
        @input
    } else {
        @input.Substring(0, length)<text>...</text>
    }
}

@{
    ViewBag.Title = "Информация про товары";
}
<script src="@Url.Content("~/Content/modern-buttons/js/jquery-1.8.0.min.js")" 
           type="text/javascript"></script>
<script src="@Url.Content("~/Content/modern-buttons/js/m-dropdown.min.js")"
        type="text/javascript"></script>

<h2>Каталог товаров</h2>

<p>
    @Html.ActionLink("Добавить товар", "Create", new {}, new {@class="mp-back"})
</p> 
<h2> @ViewBag.categoryName </h2>
<div class="album-head"> 
            На странице:
    <div class="m-btn-group">
        <a class="m-btn dropdown-toggle mini" data-toggle="dropdown" href="#">
            @Model.ItemPerPage <span class="caret"></span>
        </a>
        <ul class="m-dropdown-menu">
            <li><a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = 5, sort = @ViewBag.sort, isCategory = @ViewBag.IsCategory})" >5</a></li>
            <li><a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = 10, sort = @ViewBag.sort, isCategory = @ViewBag.IsCategory})" >10</a></li>
            <li><a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = 20, sort = @ViewBag.sort, isCategory = @ViewBag.IsCategory})" >20</a></li>
            <li><a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = 50, sort = @ViewBag.sort, isCategory = @ViewBag.IsCategory})" >50</a></li>
            <li><a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = 100, sort = @ViewBag.sort, isCategory = @ViewBag.IsCategory})" >100</a></li>
        </ul>
        @Html.PageLinks(Model.PageNo, Model.CountPage, x => Url.Action("Index", new {page = x, itemPerPage = Model.ItemPerPage, sort = @ViewBag.sort}))
    </div>
         </div> 
<table>
    <tr>
        <th>
            Название <br />
            <a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = @Model.ItemPerPage, sort = 0, isCategory = @ViewBag.IsCategory})" class ="admsort"><i class="m-icon-swapup"></i></a>
            <a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = @Model.ItemPerPage, sort = 1, isCategory = @ViewBag.IsCategory})" class ="admsort"><i class="m-icon-swapdown"></i></a>
        </th> 
        <th>
            Количество <br />
            <a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = @Model.ItemPerPage, sort = 4, isCategory = @ViewBag.IsCategory})" class ="admsort"><i class="m-icon-swapup"></i></a>
            <a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = @Model.ItemPerPage, sort = 5, isCategory = @ViewBag.IsCategory})" class ="admsort"><i class="m-icon-swapdown"></i></a>
        </th>
        <th> 
            Цена <br />
            <a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = @Model.ItemPerPage, sort = 2, isCategory = @ViewBag.IsCategory})" class ="admsort"><i class="m-icon-swapup"></i></a>
            <a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = @Model.ItemPerPage, sort = 3, isCategory = @ViewBag.IsCategory})" class ="admsort"><i class="m-icon-swapdown"></i></a>
        </th>
        <th>
            Продано единиц <br />
            <a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = @Model.ItemPerPage, sort = 6, isCategory = @ViewBag.IsCategory})" class ="admsort"><i class="m-icon-swapup"></i></a>
            <a href="@Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = 1, itemPerPage = @Model.ItemPerPage, sort = 7, isCategory = @ViewBag.IsCategory})" class ="admsort"><i class="m-icon-swapdown"></i></a>
        </th>
        <th>
            Описание
        </th>
        <th></th>
    </tr>
    

    @foreach (var item in Model.List) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Quantity)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Price)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Popularity)
            </td>
            <td>
                @Truncate(item.Description, 25)
            </td>

            <td>
                @Html.ActionLink("Редактировать", "Edit", new { id=item.ProductId }, new {@class="mp-back"}) |
                @Html.ActionLink("Подробно", "Details", new { id=item.ProductId }, new {@class="mp-back"}) |
                @Html.ActionLink("Удалить", "Delete", new { id=item.ProductId }, new {@class="mp-back"})
            </td>
        </tr>
    }

</table>
<div class="m-btn-group">
        @Html.PageLinks(Model.PageNo, Model.CountPage, x => Url.Action("IndexConcrete", new {id = @ViewBag.categoryId, page = x, itemPerPage = Model.ItemPerPage, sort = @ViewBag.sort, isCategory = @ViewBag.IsCategory }))
 </div>